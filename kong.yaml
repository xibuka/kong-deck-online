_format_version: "3.0"
services:
- connect_timeout: 60000
  enabled: true
  host: httpbin.org
  name: dummy
  path: /uuid
  port: 80
  protocol: http
  read_timeout: 60000
  retries: 5
  routes:
  - https_redirect_status_code: 426
    name: bedrock_route
    path_handling: v0
    paths:
    - /bedrock
    plugins:
    - config:
        auth:
          allow_override: false
          aws_access_key_id: null
          aws_secret_access_key: null
          azure_client_id: null
          azure_client_secret: null
          azure_tenant_id: null
          azure_use_managed_identity: false
          gcp_service_account_json: null
          gcp_use_service_account: false
          header_name: null
          header_value: null
          param_location: null
          param_name: null
          param_value: null
        logging:
          log_payloads: false
          log_statistics: false
        max_request_body_size: 8192
        model:
          name: anthropic.claude-3-5-sonnet-20240620-v1:0
          options:
            anthropic_version: null
            azure_api_version: "2023-05-15"
            azure_deployment_id: null
            azure_instance: null
            bedrock:
              aws_region: us-east-1
            gemini: null
            huggingface: null
            input_cost: null
            llama2_format: null
            max_tokens: 256
            mistral_format: null
            output_cost: null
            temperature: null
            top_k: null
            top_p: null
            upstream_path: null
            upstream_url: null
          provider: bedrock
        model_name_header: true
        response_streaming: allow
        route_type: llm/v1/chat
      enabled: true
      name: ai-proxy
      protocols:
      - grpc
      - grpcs
      - http
      - https
    - config:
        dictionary_name: kong_rate_limiting_counters
        disable_penalty: false
        error_code: 429
        error_hide_providers: false
        error_message: 'AI token rate limit exceeded for provider(s): '
        header_name: null
        hide_client_headers: false
        identifier: consumer
        llm_providers:
        - limit: 10
          name: bedrock
          window_size: 60
        path: null
        redis:
          cluster_addresses: null
          cluster_max_redirections: 5
          cluster_nodes: null
          connect_timeout: 2000
          connection_is_proxied: false
          database: 0
          host: 127.0.0.1
          keepalive_backlog: null
          keepalive_pool_size: 256
          password: null
          port: 6379
          read_timeout: 2000
          send_timeout: 2000
          sentinel_addresses: null
          sentinel_master: null
          sentinel_nodes: null
          sentinel_password: null
          sentinel_role: null
          sentinel_username: null
          server_name: null
          ssl: false
          ssl_verify: false
          timeout: 2000
          username: null
        request_prompt_count_function: null
        retry_after_jitter_max: 0
        strategy: local
        sync_rate: null
        tokens_count_strategy: total_tokens
        window_type: sliding
      enabled: true
      name: ai-rate-limiting-advanced
      protocols:
      - grpc
      - grpcs
      - http
      - https
    preserve_host: false
    protocols:
    - http
    - https
    regex_priority: 0
    request_buffering: true
    response_buffering: true
    strip_path: true
  write_timeout: 60000
